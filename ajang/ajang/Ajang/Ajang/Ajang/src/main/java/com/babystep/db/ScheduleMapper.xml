<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.babystep.db.ScheduleMapper">

	<!-- 일정 추가 쿼리 -->
	<insert id="addSchedule" parameterType="ScheduleDTO">
		INSERT INTO TB_SCHEDULE (
	    	SCHE_TITLE, SCHE_CONTENT, SCHE_ST_DT, SCHE_ED_DT, CREATED_AT, USER_ID
		) VALUES (
			#{scheTitle}, #{scheContent}, #{scheStDt}, #{scheEdDt}, SYSDATE, #{userId} 
		)
	</insert>
	
	
	<!--  특정 날짜의 일정 조회  -->
	<select id="getSchedulesByDate" parameterType="map" resultType="ScheduleDTO"> 
		SELECT SCHE_TITLE as scheTitle 
			FROM TB_SCHEDULE 
			WHERE USER_ID = #{userId} 
			AND SCHE_ST_DT &lt;= #{selectedDate} 
			AND SCHE_ED_DT &gt;= #{selectedDate} 
	</select>
	
	
	<!-- 일정 공유자 등록 -->
	<insert id="addShare" parameterType="map">
		INSERT INTO TB_SCHEDULE_SHARE (
			SHARE_ID, CREATED_AT	
			) VALUES (
			#(shareId), SYSDATE
		)
	</insert>
	
	
	<!-- 공유 일정 조회 -->
	<select id="getSharedSchedules" parameterType="String" resultType="ScheduleDTO">
    	SELECT S.SCHE_TITLE, S.SCHE_CONTENT, S.SCHE_ST_DT, S.SCHE_ED_DT
    		FROM TB_SCHEDULE S
    		JOIN TB_SHARE SH ON S.SCHE_IDX = SH.SCHE_IDX
    		WHERE SH.SHARE_ID = #{shareId}
	</select>
</mapper>